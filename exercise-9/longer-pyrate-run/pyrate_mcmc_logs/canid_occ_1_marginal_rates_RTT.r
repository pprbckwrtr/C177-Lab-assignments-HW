# 1 files combined:
# 	/home/eeb177-student/Desktop/eeb-177/lab-work/exercise-9/longer-pyrate-run/pyrate_mcmc_logs/canid_occ_1_marginal_rates.log

# 95% HPDs calculated using code from Biopy (https://www.cs.auckland.ac.nz/~yhel002/biopy/)

pdf(file='/home/eeb177-student/Desktop/eeb-177/lab-work/exercise-9/longer-pyrate-run/pyrate_mcmc_logs/canid_occ_1_marginal_rates_RTT.pdf',width=0.6*9, height=16.8)
par(mfrow=c(4,1))
library(scales)
L_hpd_m95=c(0.220726811554, 0.220726811554,0.220726811554,0.215738831836,0.174982198271,0.0425743816787,0.038641134233,0.0420433903307,0.0425406817723,0.0425406817723,0.0425406817723,0.0425406817723,0.0425406817723,0.0425406817723,0.0412273825554,0.0425406817723,0.0537975118268,0.0795609477547,0.0828594615597,0.084864653614,0.0855184519419,0.0855184519419,0.0855184519419,0.085169336267,0.084864653614,0.0828594615597,0.0804031735951,0.0804031735951,0.0802356834878,0.0465988501295,0.0864060860466,0.136256548886,0.16546860759,0.1972397239,0.197787934598,0.183957730048,0.164748063602,0.141120764317,0.141120764317,0.139299179615,0.139299179615,0.135054469786,0.128148474011,0.111861641676,0.0954193286036,0.100079932779,0.091125131172,0.091125131172,0.0975020749624)
L_hpd_M95=c(0.377469227196, 0.377469227196,0.376491165989,0.373096665602,0.398143252203,0.344655852954,0.127243660866,0.120626042599,0.120200993386,0.120223649349,0.120200993386,0.120223649349,0.120223649349,0.120223649349,0.122499982189,0.137975702115,0.161075429604,0.170147599646,0.168675886614,0.170147599646,0.170147599646,0.170147599646,0.17041809493,0.17041809493,0.171427681426,0.170009266754,0.171427681426,0.175086473424,0.17590088254,0.189077710587,0.419378420697,0.481439943222,0.487860073978,0.503677921257,0.497512276876,0.482275965059,0.46434145249,0.4513648574,0.452631447823,0.452631447823,0.474382338196,0.48031583097,0.478228408572,0.484978668693,0.485522000038,0.508787595967,0.512013737894,0.517653774569,0.527823077772)
M_hpd_m95=c(0.859020964969, 0.859020964969,0.0975601597014,0.0975601597014,0.0975601597014,0.0970858506822,0.0975951074592,0.0975601597014,0.0975601597014,0.0959751304535,0.0959751304535,0.0963050507308,0.0922226937885,0.0905271424149,0.0829012123996,0.0823174023535,0.0812693635613,0.0802573124177,0.0797070834329,0.07948763188,0.0802967446317,0.0802573124177,0.077425937669,0.0538185680355,0.0521045710485,0.0479194861206,0.0414731205892,0.0417321019265,0.0407226672608,0.0417321019265,0.0417321019265,0.0414731205892,0.0387697052337,0.0377401183904,0.0414731205892,0.0414731205892,0.041354097488,0.041354097488,0.0382171676876,0.0377401183904,0.037498754863,0.037498754863,0.037498754863,0.037498754863,0.037498754863,0.037498754863,0.037498754863,0.037498754863,0.037498754863)
M_hpd_M95=c(1.46557216621, 1.46557216621,0.171147346421,0.171147346421,0.170937272279,0.169151443389,0.168237755916,0.167459311259,0.167183264802,0.16532015093,0.162211169407,0.161212964188,0.157278488224,0.154722421897,0.147143359573,0.147143359573,0.145945532589,0.144767310554,0.144078066249,0.144078066249,0.144078066249,0.144767310554,0.144767310554,0.139813934115,0.138161814945,0.133870794484,0.124122373118,0.121741326385,0.120293264346,0.120491708899,0.119595857515,0.119595857515,0.118090696617,0.118293134454,0.12209508008,0.12209508008,0.12209508008,0.12209508008,0.119595857515,0.119506902194,0.119595857515,0.119595857515,0.119595857515,0.119595857515,0.119595857515,0.119595857515,0.119595857515,0.119595857515,0.119595857515)
R_hpd_m95=c(-1.14500024533, -1.14500024533,0.0750835109568,0.0750835109568,0.0136687550126,-0.0941966940427,-0.111711871813,-0.107994436298,-0.100762595925,-0.101033961423,-0.0966809594978,-0.0941966940427,-0.0941966940427,-0.093360004713,-0.0891425184109,-0.085624139082,-0.0625735007628,-0.047487973855,-0.0453833864507,-0.0450274218657,-0.0453833864507,-0.0384337643433,-0.0379955221799,-0.0358918875804,-0.0358918875804,-0.0286940391619,-0.0221662239494,-0.0214521762938,-0.0190950603133,-0.0267947317607,-0.013321418611,0.069475268169,0.11255595599,0.113427154198,0.122772107094,0.105802537198,0.076442720862,0.074389598059,0.0698591063614,0.0639138463194,0.0544322014469,0.05306253224,0.0354624206121,0.0429994200337,0.0228236923746,0.0295079381143,0.0171957421468,0.0171957421468,0.0144836372785)
R_hpd_M95=c(-0.510187730091, -0.510187730091,0.247107705977,0.247359655828,0.269652276962,0.226362810621,0.0200072739189,0.0106499293381,0.0144707614431,0.0144707614431,0.0163301727393,0.0169525537802,0.0167857292155,0.0155901320451,0.0200072739189,0.0327459944764,0.0662652847959,0.0662652847959,0.0662652847959,0.0662652847959,0.0643734995664,0.071141644931,0.0700258582656,0.0837540007711,0.0852337208635,0.0959627094142,0.105125178633,0.0995872474158,0.100566002002,0.114315377611,0.347289137029,0.429732279495,0.438398311292,0.428829925274,0.428829925274,0.413795631767,0.385702240689,0.385897577492,0.385897577492,0.385897577492,0.385897577492,0.395494359653,0.393661488651,0.427925360925,0.429647876866,0.450701741359,0.450304167942,0.448896107905,0.450701741359)
L_mean=c(0.288213257049, 0.288213257049,0.288306919068,0.288306359434,0.27990909348,0.219350706574,0.0877819491411,0.0836495568597,0.0829898953077,0.0829986724443,0.0828371695615,0.0828837431574,0.0829123566167,0.0830077631399,0.0844220979609,0.0913501290243,0.11494266951,0.121004663811,0.122027675493,0.122272683913,0.122503562912,0.122855571948,0.123671998733,0.124074631185,0.124304480404,0.123811161561,0.122150772038,0.121361409359,0.121382515256,0.12585609657,0.234721184831,0.32646358838,0.333993725551,0.335296457838,0.335500337953,0.331274029269,0.323315927421,0.316223324837,0.311892455817,0.309695511921,0.308105142468,0.307666362268,0.305462471471,0.306017037287,0.305956914982,0.305127996592,0.307109202488,0.306975645203,0.307797474049)
M_mean=c(1.14226477956, 1.14226477956,0.127781898704,0.127788436792,0.127773441189,0.127547900314,0.127115449629,0.126911252202,0.126627519963,0.12613869221,0.125151505696,0.124167805523,0.123737249273,0.122254007122,0.118468928284,0.116696159018,0.114862781088,0.11322434724,0.113093368513,0.113070487562,0.113153889805,0.11288100219,0.112302417633,0.104768143692,0.0997546312321,0.0885696378503,0.0830490198503,0.080280507637,0.0789680577675,0.0782599691041,0.0775568680947,0.0775618026803,0.0773444571025,0.0778001209055,0.0778740074341,0.0778740074341,0.0777588550682,0.0776371667425,0.0778969708691,0.0779781112435,0.0779590754497,0.0779590754497,0.0779809401841,0.0779809401841,0.0779809401841,0.0779809401841,0.0779809401841,0.0779809401841,0.0779809401841)
R_mean=c(-0.854051522514, -0.854051522514,0.160525020364,0.160517922642,0.152135652291,0.0918028062599,-0.0393335004883,-0.0432616953425,-0.0436376246557,-0.0431400197659,-0.0423143361341,-0.0412840623659,-0.0408248926563,-0.0392462439822,-0.0340468303232,-0.0253460299941,7.9888421577e-05,0.00778031657131,0.00893430697915,0.00920219635071,0.0093496731068,0.00997456975752,0.0113695810994,0.0193064874928,0.0245498491724,0.0352415237112,0.0391017521875,0.0410809017223,0.0424144574886,0.0475961274657,0.157164316736,0.2489017857,0.256649268449,0.257496336932,0.257626330519,0.253400021834,0.245557072353,0.238586158095,0.233995484948,0.231717400677,0.230146067018,0.229707286818,0.227481531287,0.228036097103,0.227975974798,0.227147056408,0.229128262304,0.228994705018,0.229816533865)
trans=0.5
age=(0:(49-1))* -1
plot(age,age,type = 'n', ylim = c(0, 0.580605385549), xlim = c(-51.45,2.45), ylab = 'Speciation rate', xlab = 'Ma',main='canid' )
polygon(c(age, rev(age)), c(L_hpd_M95, rev(L_hpd_m95)), col = alpha("#4c4cec",trans), border = NA)
lines(rev(age), rev(L_mean), col = "#4c4cec", lwd=3)
plot(age,age,type = 'n', ylim = c(0, 1.61212938283), xlim = c(-51.45,2.45), ylab = 'Extinction rate', xlab = 'Ma' )
polygon(c(age, rev(age)), c(M_hpd_M95, rev(M_hpd_m95)), col = alpha("#e34a33",trans), border = NA)
lines(rev(age), rev(M_mean), col = "#e34a33", lwd=3)
plot(age,age,type = 'n', ylim = c(-1.25950026986, 0.495771915495), xlim = c(-51.45,2.45), ylab = 'Net diversification rate', xlab = 'Ma' )
abline(h=0,lty=2,col="darkred")
polygon(c(age, rev(age)), c(R_hpd_M95, rev(R_hpd_m95)), col = alpha("#504A4B",trans), border = NA)
lines(rev(age), rev(R_mean), col = "#504A4B", lwd=3)
plot(age,age,type = 'n', ylim = c(0, max(1/M_mean)), xlim = c(-51.45,2.45), ylab = 'Longevity (Myr)', xlab = 'Ma' )
lines(rev(age), rev(1/M_mean), col = "#504A4B", lwd=3)
n <- dev.off()